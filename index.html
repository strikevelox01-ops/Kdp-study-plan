<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FocusFlow Pro v2.0</title>
    <style>
        :root {
            --bg: #F8F9FD;
            --primary: #4361EE;
            --secondary: #FF4D6D;
            --success: #2EC4B6;
            --warning: #FF9F1C;
            --dark: #0B090A;
            --grey: #ADB5BD;
            --card-shadow: 0 12px 24px rgba(0,0,0,0.04);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', -apple-system, sans-serif; -webkit-font-smoothing: antialiased; }
        body { background: var(--bg); color: var(--dark); display: flex; justify-content: center; overflow-x: hidden; }

        .app-shell {
            width: 100%; max-width: 480px; min-height: 100vh;
            background: var(--white); position: relative;
            padding: 40px 24px 120px;
        }

        /* Views */
        .view { display: none; animation: fadeIn 0.4s ease; }
        .view.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Typography */
        h1 { font-size: 32px; font-weight: 800; letter-spacing: -1px; }
        h2 { font-size: 20px; font-weight: 700; margin: 25px 0 15px; display: flex; justify-content: space-between; align-items: center; }
        .subtitle { color: var(--grey); font-size: 14px; margin-bottom: 5px; font-weight: 500; }

        /* Search Bar */
        .search-box {
            background: #EDF2F4; border-radius: 16px; padding: 12px 20px;
            display: flex; align-items: center; margin-bottom: 20px;
        }
        .search-box input {
            background: transparent; border: none; outline: none;
            width: 100%; font-size: 16px; margin-left: 10px;
        }

        /* Progress Cards */
        .subject-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
        .card {
            background: white; border-radius: 28px; padding: 20px;
            box-shadow: var(--card-shadow); position: relative;
            transition: var(--transition); border: 1px solid rgba(0,0,0,0.02);
        }
        .card:active { transform: scale(0.95); }
        .card-icon { width: 45px; height: 45px; border-radius: 14px; display: flex; 
                    align-items: center; justify-content: center; font-size: 22px; margin-bottom: 15px; }
        
        /* Progress Ring */
        .progress-ring {
            position: absolute; top: 20px; right: 20px;
            width: 35px; height: 35px;
        }

        /* Task List */
        .task-list { margin-top: 10px; }
        .task-item {
            background: white; padding: 18px; border-radius: 20px;
            margin-bottom: 12px; display: flex; align-items: center;
            box-shadow: var(--card-shadow); border-left: 6px solid var(--primary);
        }
        .task-checkbox { 
            width: 22px; height: 22px; border-radius: 6px; 
            border: 2px solid var(--grey); margin-right: 15px; cursor: pointer;
        }
        .task-item.done { opacity: 0.6; }
        .task-item.done .task-checkbox { background: var(--success); border-color: var(--success); }

        /* Bottom Menu */
        nav {
            position: fixed; bottom: 25px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 400px; background: #1a1a2e;
            display: flex; justify-content: space-around; padding: 18px;
            border-radius: 35px; box-shadow: 0 15px 35px rgba(0,0,0,0.2); z-index: 1000;
        }
        .nav-link { color: #5c5c7d; font-size: 22px; cursor: pointer; transition: 0.3s; }
        .nav-link.active { color: white; transform: translateY(-5px); }

        /* Form Styling */
        .modal-body { padding: 10px 0; }
        .input-group { margin-bottom: 20px; }
        label { display: block; font-size: 13px; font-weight: 700; color: var(--grey); margin-bottom: 8px; text-transform: uppercase; }
        input, select { 
            width: 100%; padding: 16px; border-radius: 16px; 
            border: 2px solid #F1F3F5; font-size: 16px; transition: 0.2s;
        }
        input:focus { border-color: var(--primary); outline: none; }
        .btn {
            width: 100%; padding: 18px; border-radius: 18px; border: none;
            background: var(--primary); color: white; font-size: 16px; font-weight: 700;
            cursor: pointer; box-shadow: 0 10px 20px rgba(67, 97, 238, 0.2);
        }

        /* Custom FAB */
        .fab {
            background: var(--secondary); color: white; border: none;
            width: 55px; height: 55px; border-radius: 20px;
            font-size: 24px; cursor: pointer; display: flex; 
            align-items: center; justify-content: center;
        }
    </style>
</head>
<body>

<div class="app-shell">
    
    <div id="dashView" class="view active">
        <p class="subtitle" id="currentDate"></p>
        <h1 id="userNameHeading">FocusFlow</h1>
        
        <div class="search-box">
            <span>üîç</span>
            <input type="text" placeholder="Search subjects..." id="subjectSearch" oninput="filterSubjects()">
        </div>

        <h2>Curriculum <button class="fab" onclick="navigate('addView')" style="width:40px; height:40px; font-size:18px;">+</button></h2>
        <div class="subject-grid" id="subjectGrid"></div>

        <h2>Today's Tasks</h2>
        <div class="task-list" id="taskList"></div>
        <button class="btn" onclick="addNewTask()" style="background: transparent; color: var(--primary); box-shadow: none; border: 2px dashed #ddd;">+ Add New Task</button>
    </div>

    <div id="addView" class="view">
        <h2>Add Subject</h2>
        <div class="modal-body">
            <div class="input-group">
                <label>Subject Name</label>
                <input type="text" id="newSubName" placeholder="e.g. Astrophysics">
            </div>
            <div class="input-group">
                <label>Theme Color</label>
                <select id="newSubColor">
                    <option value="var(--primary)">Cobalt Blue</option>
                    <option value="var(--secondary)">Sunset Red</option>
                    <option value="var(--success)">Mint Green</option>
                    <option value="var(--warning)">Amber Gold</option>
                </select>
            </div>
            <div class="input-group">
                <label>Icon</label>
                <input type="text" id="newSubIcon" placeholder="Paste emoji here">
            </div>
            <button class="btn" onclick="saveSubject()">Create Subject</button>
            <p onclick="navigate('dashView')" style="text-align:center; margin-top:20px; color:var(--grey); cursor:pointer;">Go Back</p>
        </div>
    </div>

    <div id="settingsView" class="view">
        <h2>Settings</h2>
        <div class="input-group">
            <label>Change User Name</label>
            <input type="text" id="userNameInput" placeholder="Enter name..." onchange="updateProfile()">
        </div>
        <div style="margin-top: 50px;">
            <p style="color:red; font-weight:700;">DANGER ZONE</p>
            <button class="btn" style="background:#ff4d4d; margin-top:10px;" onclick="resetApp()">Reset All Data</button>
        </div>
    </div>

    <nav>
        <div class="nav-link active" onclick="navigate('dashView', this)">üè†</div>
        <div class="nav-link" onclick="navigate('settingsView', this)">‚öôÔ∏è</div>
    </nav>
</div>

<script>
    // APP STATE & STORAGE
    let state = {
        user: localStorage.getItem('ff_user') || 'Scholar',
        subjects: JSON.parse(localStorage.getItem('ff_subs')) || [],
        tasks: JSON.parse(localStorage.getItem('ff_tasks')) || []
    };

    // UI CONTROLLER
    function navigate(viewId, el) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById(viewId).classList.add('active');
        if(el) {
            document.querySelectorAll('.nav-link').forEach(n => n.classList.remove('active'));
            el.classList.add('active');
        }
    }

    // SUBJECT LOGIC
    function saveSubject() {
        const name = document.getElementById('newSubName').value;
        const color = document.getElementById('newSubColor').value;
        const icon = document.getElementById('newSubIcon').value || 'üìö';

        if(!name) return alert("Enter a name!");

        state.subjects.push({ id: Date.now(), name, color, icon, progress: 0 });
        sync();
        render();
        navigate('dashView');
    }

    function filterSubjects() {
        const term = document.getElementById('subjectSearch').value.toLowerCase();
        render(term);
    }

    // TASK LOGIC
    function addNewTask() {
        const t = prompt("What do you need to do today?");
        if(t) {
            state.tasks.push({ id: Date.now(), text: t, done: false });
            sync();
            render();
        }
    }

    function toggleTask(id) {
        const task = state.tasks.find(t => t.id === id);
        task.done = !task.done;
        sync();
        render();
    }

    // RENDER ENGINE
    function render(filter = "") {
        const grid = document.getElementById('subjectGrid');
        const taskList = document.getElementById('taskList');
        document.getElementById('userNameHeading').innerText = "Hi, " + state.user;
        document.getElementById('userNameInput').value = state.user;

        // Render Subjects
        grid.innerHTML = "";
        const filtered = state.subjects.filter(s => s.name.toLowerCase().includes(filter));
        
        if(filtered.length === 0) grid.innerHTML = "<p style='grid-column:span 2; color:#999;'>No subjects found.</p>";
        
        filtered.forEach(s => {
            grid.innerHTML += `
                <div class="card" onclick="updateProgress(${s.id})">
                    <div class="card-icon" style="background:${s.color}20; color:${s.color}">${s.icon}</div>
                    <strong>${s.name}</strong>
                    <div class="subtitle">${s.progress}% Done</div>
                </div>
            `;
        });

        // Render Tasks
        taskList.innerHTML = "";
        state.tasks.forEach(t => {
            taskList.innerHTML += `
                <div class="task-item ${t.done ? 'done' : ''}" onclick="toggleTask(${t.id})">
                    <div class="task-checkbox"></div>
                    <span>${t.text}</span>
                </div>
            `;
        });
    }

    function updateProgress(id) {
        const s = state.subjects.find(x => x.id === id);
        let p = prompt("Update progress (0-100):", s.progress);
        if(p !== null) {
            s.progress = Math.min(100, Math.max(0, parseInt(p)));
            sync();
            render();
        }
    }

    function updateProfile() {
        state.user = document.getElementById('userNameInput').value;
        sync();
        render();
    }

    function sync() {
        localStorage.setItem('ff_user', state.user);
        localStorage.setItem('ff_subs', JSON.stringify(state.subjects));
        localStorage.setItem('ff_tasks', JSON.stringify(state.tasks));
    }

    function resetApp() {
        if(confirm("Wipe all data?")) {
            localStorage.clear();
            location.reload();
        }
    }

    window.onload = () => {
        document.getElementById('currentDate').innerText = new Date().toDateString();
        render();
    };
</script>
</body>
</html>
