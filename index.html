<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FocusFlow Elite | v3.0</title>
    <style>
        :root {
            --bg: #F0F2F5;
            --surface: #FFFFFF;
            --primary: #3D5AFE;
            --secondary: #FF6E40;
            --success: #00C853;
            --warning: #FFAB00;
            --text-main: #1C1E21;
            --text-muted: #606770;
            --border: #E4E6EB;
            --nav-dark: #1A1A2E;
            --shadow: 0 12px 28px rgba(0, 0, 0, 0.08);
            --radius-lg: 28px;
            --radius-md: 18px;
        }

        [data-theme="dark"] {
            --bg: #18191A;
            --surface: #242526;
            --text-main: #E4E6EB;
            --text-muted: #B0B3B8;
            --border: #3E4042;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', -apple-system, sans-serif; transition: background 0.3s, color 0.3s; }
        body { background: var(--bg); color: var(--text-main); display: flex; justify-content: center; min-height: 100vh; }

        .app-shell {
            width: 100%; max-width: 500px; background: var(--bg); position: relative;
            padding: 20px 20px 100px; overflow-x: hidden;
        }

        /* --- UI COMPONENTS --- */
        .view { display: none; animation: slideUp 0.4s cubic-bezier(0.18, 0.89, 0.32, 1.28); }
        .view.active { display: block; }

        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        header { display: flex; justify-content: space-between; align-items: center; padding: 20px 0; }
        .chip { background: var(--success); color: white; padding: 6px 14px; border-radius: 12px; font-size: 12px; font-weight: 700; }

        .search-bar {
            background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-md);
            padding: 12px 18px; display: flex; align-items: center; margin-bottom: 25px; box-shadow: var(--shadow);
        }
        .search-bar input { border: none; background: transparent; color: var(--text-main); width: 100%; margin-left: 10px; outline: none; }

        /* Subject Cards */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .card {
            background: var(--surface); border-radius: var(--radius-lg); padding: 24px;
            position: relative; box-shadow: var(--shadow); border: 1px solid var(--border);
            cursor: pointer; overflow: hidden;
        }
        .card::after { content: ''; position: absolute; bottom: 0; left: 0; height: 6px; width: 100%; background: var(--primary); }
        .card-icon { font-size: 26px; margin-bottom: 15px; background: #3d5afe15; width: 50px; height: 50px; 
                     display: flex; align-items: center; justify-content: center; border-radius: 14px; }
        
        /* Pomodoro Timer */
        .timer-container {
            background: var(--nav-dark); color: white; border-radius: var(--radius-lg);
            padding: 40px 20px; text-align: center; margin-top: 20px;
        }
        #timerDisplay { font-size: 64px; font-weight: 800; font-variant-numeric: tabular-nums; margin: 10px 0; }
        .timer-btns { display: flex; justify-content: center; gap: 15px; }
        .t-btn { background: rgba(255,255,255,0.1); border: none; color: white; padding: 10px 20px; border-radius: 12px; cursor: pointer; }
        .t-btn.start { background: var(--success); }

        /* Stats Section */
        .stat-row { display: flex; gap: 15px; margin-top: 20px; }
        .stat-box { background: var(--surface); flex: 1; padding: 20px; border-radius: var(--radius-md); text-align: center; box-shadow: var(--shadow); }

        /* Navigation */
        nav {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 440px; background: var(--nav-dark);
            padding: 15px; border-radius: 30px; display: flex; justify-content: space-around;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3); z-index: 999;
        }
        .nav-item { color: #5c5c7d; font-size: 22px; cursor: pointer; transition: 0.3s; }
        .nav-item.active { color: white; transform: translateY(-5px); }

        /* Forms */
        .btn-full { width: 100%; padding: 18px; border-radius: 16px; border: none; font-weight: 700; cursor: pointer; margin-top: 15px; }
        .btn-primary { background: var(--primary); color: white; }
        .input-group { margin-bottom: 20px; }
        .input-group label { display: block; font-size: 12px; font-weight: 800; color: var(--text-muted); margin-bottom: 8px; text-transform: uppercase; }
        input, select { width: 100%; padding: 16px; border-radius: 14px; border: 2px solid var(--border); background: var(--surface); color: var(--text-main); }
    </style>
</head>
<body data-theme="light">

<div class="app-shell">
    
    <div id="dashView" class="view active">
        <header>
            <div>
                <p id="headerDate" style="color: var(--text-muted); font-size: 14px;"></p>
                <h1 id="userName">Hey Student!</h1>
            </div>
            <div class="chip" id="totalTasks">0 Subjects</div>
        </header>

        <div class="search-bar">
            <span>üîç</span>
            <input type="text" placeholder="Search your subjects..." id="searchInp" oninput="ui.renderSubjects()">
        </div>

        <div class="grid" id="subjectGrid"></div>
        
        <div class="stat-row">
            <div class="stat-box">
                <p style="font-size: 12px; color: var(--text-muted);">Study Time</p>
                <h3 id="statTime">0m</h3>
            </div>
            <div class="stat-box">
                <p style="font-size: 12px; color: var(--text-muted);">Completed</p>
                <h3 id="statDone">0%</h3>
            </div>
        </div>
    </div>

    <div id="timerView" class="view">
        <h2 style="margin-bottom: 20px;">Deep Focus</h2>
        <div class="timer-container">
            <p id="timerLabel">STUDY SESSION</p>
            <div id="timerDisplay">25:00</div>
            <div class="timer-btns">
                <button class="t-btn start" id="timerStart" onclick="timer.toggle()">Start</button>
                <button class="t-btn" onclick="timer.reset()">Reset</button>
            </div>
        </div>
        <div style="margin-top: 30px;">
            <h3>Focus Music</h3>
            <div class="card" style="margin-top:10px; display:flex; align-items:center; gap:15px; padding:15px;">
                <span>üéµ</span>
                <div>
                    <strong>Lo-fi Study Beats</strong>
                    <p style="font-size:12px; color:var(--text-muted);">Recommended for focus</p>
                </div>
            </div>
        </div>
    </div>

    <div id="addView" class="view">
        <h2>New Subject</h2>
        <div style="margin-top: 25px;">
            <div class="input-group">
                <label>Subject Title</label>
                <input type="text" id="subTitle" placeholder="Physics, Art, Math...">
            </div>
            <div class="input-group">
                <label>Total Modules</label>
                <input type="number" id="subModules" placeholder="How many chapters?">
            </div>
            <div class="input-group">
                <label>Theme</label>
                <select id="subColor">
                    <option value="var(--primary)">Cobalt Blue</option>
                    <option value="var(--secondary)">Sunset Orange</option>
                    <option value="var(--success)">Emerald Green</option>
                    <option value="var(--warning)">Bright Amber</option>
                </select>
            </div>
            <button class="btn-full btn-primary" onclick="actions.addSubject()">Create Area</button>
            <button class="btn-full" onclick="ui.navigate('dashView')" style="background:transparent; color:var(--text-muted);">Cancel</button>
        </div>
    </div>

    <div id="settingsView" class="view">
        <h2>Settings</h2>
        <div style="margin-top: 25px;">
            <div class="input-group">
                <label>User Name</label>
                <input type="text" id="userNameInp" placeholder="Your Name" onchange="actions.saveName()">
            </div>
            <div class="input-group">
                <label>Appearance</label>
                <button class="btn-full" onclick="actions.toggleTheme()" style="background:var(--border);">Toggle Dark/Light Mode</button>
            </div>
            <div style="margin-top: 100px; border-top: 1px solid var(--border); padding-top: 20px;">
                <p style="color:red; font-size:12px; font-weight:800; margin-bottom:10px;">DANGER ZONE</p>
                <button class="btn-full" style="background:#ff3b30; color:white;" onclick="actions.reset()">Wipe All Storage</button>
            </div>
        </div>
    </div>

    <nav>
        <div class="nav-item active" onclick="ui.navigate('dashView', this)">üè†</div>
        <div class="nav-item" onclick="ui.navigate('timerView', this)">‚è±Ô∏è</div>
        <div class="nav-item" onclick="ui.navigate('addView', this)">‚ûï</div>
        <div class="nav-item" onclick="ui.navigate('settingsView', this)">‚öôÔ∏è</div>
    </nav>
</div>

<script>
    // --- APP CORE STATE ---
    const app = {
        data: JSON.parse(localStorage.getItem('ff_pro_data')) || {
            name: 'Scholar',
            subjects: [],
            totalMinutesStudy: 0,
            theme: 'light'
        }
    };

    // --- UI ENGINE ---
    const ui = {
        navigate(id, el) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            if(el) {
                document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
                el.classList.add('active');
            }
        },

        renderSubjects() {
            const grid = document.getElementById('subjectGrid');
            const term = document.getElementById('searchInp').value.toLowerCase();
            const filtered = app.data.subjects.filter(s => s.title.toLowerCase().includes(term));
            
            grid.innerHTML = filtered.length ? '' : '<p style="grid-column:span 2; text-align:center; padding:40px; color:#999;">No subjects yet.</p>';
            
            filtered.forEach(s => {
                const card = document.createElement('div');
                card.className = 'card';
                card.style.setProperty('--primary', s.color);
                card.onclick = () => actions.increment(s.id);
                card.innerHTML = `
                    <div class="card-icon" style="color:${s.color}">üìö</div>
                    <strong>${s.title}</strong>
                    <p style="font-size:12px; color:var(--text-muted); margin-top:5px;">
                        ${s.completed}/${s.total} Modules Done
                    </p>
                `;
                grid.appendChild(card);
            });

            document.getElementById('totalTasks').innerText = `${app.data.subjects.length} Subjects`;
            document.getElementById('statTime').innerText = `${app.data.totalMinutesStudy}m`;
            document.getElementById('userName').innerText = `Hi, ${app.data.name}`;
            document.getElementById('statDone').innerText = this.calcTotalProgress() + '%';
        },

        calcTotalProgress() {
            if(!app.data.subjects.length) return 0;
            let total = 0, done = 0;
            app.data.subjects.forEach(s => { total += parseInt(s.total); done += s.completed; });
            return Math.round((done/total) * 100) || 0;
        }
    };

    // --- ACTION HANDLERS ---
    const actions = {
        addSubject() {
            const title = document.getElementById('subTitle').value;
            const total = document.getElementById('subModules').value;
            const color = document.getElementById('subColor').value;
            
            if(!title || !total) return alert("Fill all fields");
            
            app.data.subjects.push({
                id: Date.now(),
                title, total, color, completed: 0
            });
            this.save();
            ui.renderSubjects();
            ui.navigate('dashView');
        },

        increment(id) {
            const s = app.data.subjects.find(x => x.id === id);
            if(s.completed < s.total) s.completed++;
            this.save();
            ui.renderSubjects();
        },

        saveName() {
            app.data.name = document.getElementById('userNameInp').value;
            this.save();
            ui.renderSubjects();
        },

        toggleTheme() {
            app.data.theme = app.data.theme === 'light' ? 'dark' : 'light';
            document.body.setAttribute('data-theme', app.data.theme);
            this.save();
        },

        reset() {
            if(confirm("Wipe everything?")) {
                localStorage.clear();
                location.reload();
            }
        },

        save() {
            localStorage.setItem('ff_pro_data', JSON.stringify(app.data));
        }
    };

    // --- TIMER ENGINE ---
    const timer = {
        timeLeft: 1500,
        running: false,
        interval: null,

        toggle() {
            if(this.running) {
                clearInterval(this.interval);
                document.getElementById('timerStart').innerText = "Start";
            } else {
                this.interval = setInterval(() => this.tick(), 1000);
                document.getElementById('timerStart').innerText = "Pause";
            }
            this.running = !this.running;
        },

        tick() {
            if(this.timeLeft <= 0) {
                clearInterval(this.interval);
                alert("Session Complete!");
                app.data.totalMinutesStudy += 25;
                actions.save();
                this.reset();
                return;
            }
            this.timeLeft--;
            this.updateDisplay();
        },

        updateDisplay() {
            const m = Math.floor(this.timeLeft / 60);
            const s = this.timeLeft % 60;
            document.getElementById('timerDisplay').innerText = `${m}:${s < 10 ? '0' : ''}${s}`;
        },

        reset() {
            clearInterval(this.interval);
            this.running = false;
            this.timeLeft = 1500;
            this.updateDisplay();
            document.getElementById('timerStart').innerText = "Start";
        }
    };

    // --- INIT ---
    window.onload = () => {
        document.getElementById('headerDate').innerText = new Date().toDateString();
        document.body.setAttribute('data-theme', app.data.theme);
        ui.renderSubjects();
    };
</script>
</body>
</html>
